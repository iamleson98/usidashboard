import{d as x,r as _,G as H,H as o,P as e,ag as r,u as a,o as D,X as Q,k as W,j,w as G,c as V,a as i,O as k,a6 as X,L as Y,M as w,t as A}from"./@vue.BDy9tIRg.2025-05-27_1207.js";import{h as J}from"./http.BQFYt1x1.2025-05-27_1207.js";import{d as T}from"./dayjs.DXEKZA6n.2025-05-27_1207.js";import"./axios.xsH4HHeE.2025-05-27_1207.js";const K=x({__name:"abnormalDetail",props:{detail:{}},setup(s){let y=_([s.detail]);return(v,h)=>{const p=r("el-table-column"),n=r("el-table");return D(),H(n,{data:a(y),border:"",style:{width:"100%"}},{default:o(()=>[e(p,{prop:"checkout_station",label:"Checkout Station",width:"180"}),e(p,{prop:"checkin_station",label:"Name",width:"180"}),e(p,{prop:"employee_id",label:"Employee ID"}),e(p,{props:"in_time",label:"In Time"})]),_:1},8,["data"])}}}),Z={usiApi:"http://localhost:8000/v1"},ee=s=>Object.keys(s).filter(d=>!!s[d]).map(d=>`${encodeURIComponent(d)}=${encodeURIComponent(s[d])}`).join("&"),te=async s=>(await J.get(`${Z.usiApi}/abnormals/?${ee(s)}`)).data,le="ASM",oe="PD1",ae="PD2",ne="PD3",re="TE",ie="ME",se="QMD",de="SMT",pe="GA",me="IE",ue="SASM",_e="SWH",ce="EQ",fe="FAEE",be="WH",ye="IT",ge="SCM",we="OPM",De="HR",ve="EHS",he="PT",Me="PE",Se="FD",Ee="ALL",Ce=[Ee,le,oe,ae,ne,re,ie,se,de,pe,me,ue,_e,ce,fe,be,ye,ge,we,De,ve,he,Me,Se],Pe={style:{display:"flex",width:"100%"}},Ve={style:{"margin-top":"20px"}},xe=x({__name:"BasicTable",setup(s){const d=_(),y=_(),v=_([]),h=_(0),p=_(),n=Q({employee_id:"",start_time:void 0,end_time:void 0,floor_number:1,query:"",count_total:!0,limit:100,offset:0,department:""}),M=W(()=>n.offset/n.limit+1);j(async()=>{await c()});const I=_("Abnormal information details"),S=_(!1);async function c(){const m=await te(n);m.status===200&&(v.value=m.records,h.value=m.total)}function R(m){const{prop:t,order:g}=m;g&&(n.order_by=t,n.order_direction=g,c())}const U=m=>{n.offset=(m-1)*n.limit,c()};function F(){y.value.resetFields()}return G(()=>p,()=>console.log(p.value)),(m,t)=>{const g=r("el-option"),L=r("el-select"),f=r("el-form-item"),b=r("el-col"),B=r("el-input"),E=r("el-date-picker"),C=r("el-button"),N=r("el-row"),O=r("el-form"),P=r("el-card"),u=r("el-table-column"),z=r("el-table"),$=r("el-pagination"),q=r("el-dialog");return D(),V(k,null,[i("div",null,[e(P,{shadow:"never"},{default:o(()=>[e(O,{ref_key:"formRef",ref:y,model:a(n),inline:!0,"label-width":"auto"},{default:o(()=>[e(N,{gutter:2},{default:o(()=>[e(b,{span:6},{default:o(()=>[e(f,{label:"Department",prop:"department",style:{width:"100%"}},{default:o(()=>[e(L,{placeholder:"Select department",modelValue:a(n).department,"onUpdate:modelValue":t[0]||(t[0]=l=>a(n).department=l)},{default:o(()=>[(D(!0),V(k,null,X(a(Ce),l=>(D(),H(g,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(b,{span:4},{default:o(()=>[e(f,{label:"Search",prop:"query",style:{width:"100%"}},{default:o(()=>[e(B,{modelValue:a(n).query,"onUpdate:modelValue":t[1]||(t[1]=l=>a(n).query=l),placeholder:"Enter query"},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{span:4},{default:o(()=>[e(f,{label:"Begin date",prop:"start_time",style:{width:"100%"}},{default:o(()=>[e(E,{placeholder:"Begin date",modelValue:a(n).start_time,"onUpdate:modelValue":t[2]||(t[2]=l=>a(n).start_time=l),type:"datetime","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{span:4},{default:o(()=>[e(f,{label:"End date",prop:"end_time",style:{width:"100%"}},{default:o(()=>[e(E,{placeholder:"End date",modelValue:a(n).end_time,"onUpdate:modelValue":t[3]||(t[3]=l=>a(n).end_time=l),type:"datetime","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{span:4,style:{"margin-left":"auto","margin-bottom":"0px"}},{default:o(()=>[e(f,{label:"",style:{width:"100%"}},{default:o(()=>[i("div",Pe,[t[10]||(t[10]=i("div",{style:{flex:"1"}},null,-1)),e(C,{onClick:t[4]||(t[4]=l=>F())},{default:o(()=>t[8]||(t[8]=[Y("reset")])),_:1}),e(C,{type:"primary",onClick:c},{default:o(()=>t[9]||(t[9]=[Y("Search")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(P,{style:{"margin-top":"20px"},shadow:"never"},{default:o(()=>[e(z,{stripe:"",style:{width:"100%"},ref_key:"tableRef",ref:d,data:a(v),onSortChange:R},{default:o(()=>[e(u,{fixed:"",type:"index",width:"50",label:"No."}),e(u,{prop:"employee_id",label:"Employee ID",width:"100"}),e(u,{prop:"first_name",label:"First Name",width:"100"}),e(u,{prop:"last_name",label:"Last Name",width:"100"}),e(u,{prop:"department",label:"Department",width:"150"}),e(u,{prop:"out_time",label:"Out time",sortable:"custom",width:"170"},{default:o(l=>[i("div",null,[i("p",null,w(a(T)(l.row.out_time).format("YYYY/MM/DD HH:mm")),1),t[11]||(t[11]=i("hr",null,null,-1)),i("p",null,w(l.row.checkout_station),1)])]),_:1}),e(u,{prop:"in_time",label:"In time",sortable:"custom",width:"170"},{default:o(l=>[i("div",null,[i("p",null,w(a(T)(l.row.in_time).format("YYYY/MM/DD HH:mm")),1),t[12]||(t[12]=i("hr",null,null,-1)),i("p",null,w(l.row.checkin_station),1)])]),_:1}),e(u,{prop:"total_mins",label:"gap time (minutes)",sortable:"custom"})]),_:1},8,["data"]),i("div",Ve,[e($,{layout:"total, prev, pager, next, sizes","current-page":a(M),"onUpdate:currentPage":t[5]||(t[5]=l=>A(M)?M.value=l:null),"page-size":a(n).limit,"onUpdate:pageSize":t[6]||(t[6]=l=>a(n).limit=l),"page-sizes":[100,150,200,400],total:a(h),onSizeChange:c,onCurrentChange:U},null,8,["current-page","page-size","total"])])]),_:1})]),e(q,{modelValue:a(S),"onUpdate:modelValue":t[7]||(t[7]=l=>A(S)?S.value=l:null),title:a(I),"close-on-click-modal":!1,width:"50%"},{default:o(()=>[e(K,{detail:a(p)},null,8,["detail"])]),_:1},8,["modelValue","title"])],64)}}});export{xe as default};
